# Drylax Configuration Template
# Copy this file to .env and configure with your own values
# SECURITY WARNING: Never commit .env to version control

# === Cryptographic Secret keys
# Pepper for password hashing (exact 32 byte req)
PEPPER=0123456789ABCDEF0123456789ABCDEF

# Local KMS key for testing (base64-encoded 32-byte key)
# This prevents "no KMS providers available" errors
KMS_LOCAL_KEY=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
# Deletion token key (32 bytes)
DELETION_TOKEN_KEY=0123456789ABCDEF0123456789ABCDEF

# === Worker Pool Configuration ===
HASHER_WORKER_COUNT=128
WORKER_POOL_SIZE=1000
MAX_WORKER_LOAD=5000

# === Database ===
DATABASE_PATH=./drylax.db
CONTEXT_TIMEOUT=60s

# Database Connection Pool
DB_MAX_OPEN_CONNS=250
DB_MAX_IDLE_CONNS=25
DB_QUERY_TIMEOUT=10s

# === Cache ===
LRU_CACHE_SIZE=10000

# === Password Hashing (Argon2id) ===
# Higher values = more secure but slower
# Production recommended: TIME=4, MEMORY=65536
ARGON2_TIME=4
ARGON2_MEMORY=65536
ARGON2_PARALLELISM=4
ARGON2_KEYLEN=32

# === Rate Limiting ===
RATE_LIMIT_RPM=60
TOKEN_REPLAY_TTL=1h

# === Time-to-Live Presets ===
# Comma-separated durations (valid: m, h)
TTL_PRESETS=5m,1h,24h,168h

# === Redis (Optional) ===
# Leave blank to use in-memory tracking
# Format: redis://user:password@host:port/db
REDIS_URL=

# === Application Settings ===
PORT=8080
ENVIRONMENT=development
LOG_LEVEL=info

# === Security ===
# Fail-closed: if true, server won't start without KMS
KMS_FAIL_CLOSED=true

# Trusted proxy IPs for rate limiting (comma-separated)
TRUSTED_PROXIES=

# === Advanced KMS (Production) ===
# HashiCorp Vault
#VAULT_ADDR=https://vault.example.com:8200
#VAULT_TOKEN=
#VAULT_MOUNT=transit
#VAULT_KEY_NAME=drylax-dek

# AWS KMS
#AWS_REGION=us-east-1
#AWS_KMS_KEY_ID=arn:aws:kms:region:account:key/key-id

# Load pepper from KMS instead of env var
#PEPPER_FROM_KMS=false

# === IP Privacy ===
# How often to rotate IP hash keys (prevents long-term tracking)
IP_HASH_ROTATION_INTERVAL=24h
